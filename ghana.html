<html>
	<head>
		<!-- Required meta tags -->
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />

		<!-- Bootstrap CSS -->
		<link
			href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
			rel="stylesheet"
			integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
			crossorigin="anonymous"
		/>

		<title>Generate Loan Agreement</title>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/docxtemplater/3.28.2/docxtemplater.js"></script>
		<script src="https://unpkg.com/pizzip@3.1.1/dist/pizzip.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.8/FileSaver.js"></script>
		<script src="https://unpkg.com/pizzip@3.1.1/dist/pizzip-utils.js"></script>

		<script type="text/javascript" src="./toWord.js"></script>
	</head>
	<body>
		<main class="my-5 mx-2">
			<div>
				<div class="text-center text-uppercase fs-2 fw-bold my-2">
					Generate Loan Agreement for Get Gari Ghana
				</div>

				<div class="text-center mb-5 fw-bold">Fill with capital letters</div>

				<ul class="nav">
					<li class="nav-item">
						<a class="nav-link" href="index.html">Nigeria</a>
					</li>
					<li class="nav-item">
						<p class="nav-link text-black-50 text-decoration-underline">Ghana</p>
					</li>
				</ul>
				<form class="col-lg-6 col-md-8 col-sm-12 mx-auto">
					<div class="mb-3 row">
						<label for="date" class="col-sm-3 col-form-label">Date</label>
						<div class="col-sm-9">
							<input type="date" class="form-control" id="date" required />
						</div>
					</div>
					<div class="mb-3 row">
						<label for="name" class="col-sm-3 col-form-label">Name</label>
						<div class="col-sm-9">
							<input type="text" class="form-control" id="name" />
						</div>
					</div>
					<div class="mb-3 row">
						<label for="no" class="col-sm-3 col-form-label">House Number</label>
						<div class="col-sm-9">
							<input type="text" class="form-control" id="no" />
						</div>
					</div>
					<div class="mb-3 row">
						<label for="street" class="col-sm-3 col-form-label">Street Name</label>
						<div class="col-sm-9">
							<input type="text" class="form-control" id="street" />
						</div>
					</div>
					<div class="mb-3 row">
						<label for="lga" class="col-sm-3 col-form-label">LGA</label>
						<div class="col-sm-9">
							<input type="text" class="form-control" id="lga" />
						</div>
					</div>
					<div class="mb-3 row">
						<label for="state" class="col-sm-3 col-form-label">STATE</label>
						<div class="col-sm-9">
							<input type="text" class="form-control" id="state" />
						</div>
					</div>
					<div class="mb-3 row">
						<label for="amount" class="col-sm-3 col-form-label">LOAN AMOUNT</label>
						<div class="col-sm-9">
							<input type="number" class="form-control" id="amount" />
						</div>
					</div>
					<div class="mb-3 row">
						<label for="interest" class="col-sm-3 col-form-label text-uppercase"
							>INTEREST RATE per year</label
						>
						<div class="col-sm-9">
							<input type="number" class="form-control" id="interest" />
						</div>
					</div>
					<div class="mb-3 row">
						<label for="tenure" class="col-sm-3 col-form-label text-uppercase"
							>tenure</label
						>
						<div class="col-sm-9">
							<input type="number" class="form-control" id="tenure" />
						</div>
					</div>
					<div class="mb-3 row">
						<label for="make" class="col-sm-3 col-form-label text-uppercase"
							>Vehicle make</label
						>
						<div class="col-sm-9">
							<input type="text" class="form-control" id="make" />
						</div>
					</div>
					<div class="mb-3 row">
						<label for="model" class="col-sm-3 col-form-label text-uppercase"
							>Vehicle model</label
						>
						<div class="col-sm-9">
							<input type="text" class="form-control" id="model" />
						</div>
					</div>
					<div class="mb-3 row">
						<label for="year" class="col-sm-3 col-form-label text-uppercase"
							>Vehicle year</label
						>
						<div class="col-sm-9">
							<input type="text" class="form-control" id="year" />
						</div>
					</div>
					<div class="mb-3 row">
						<label for="condition" class="col-sm-3 col-form-label text-uppercase"
							>Vehicle condition</label
						>
						<div class="col-sm-9">
							<select
								class="form-select text-uppercase"
								aria-label="multiple select example"
								id="condition"
							>
								<option selected></option>
								<option value="Foreign Used">Foreign Used</option>
								<option value="New">New</option>
							</select>
						</div>
					</div>
					<div class="mb-3 row">
						<label for="vin" class="col-sm-3 col-form-label text-uppercase"
							>VIN</label
						>
						<div class="col-sm-9">
							<input type="text" class="form-control" id="vin" />
						</div>
					</div>
					<div class="mb-3 row">
						<label for="carValue" class="col-sm-3 col-form-label text-uppercase"
							>Vehicle Price</label
						>
						<div class="col-sm-9">
							<input type="number" class="form-control" id="carValue" />
						</div>
					</div>
					<div class="mb-3 row">
						<label for="equity" class="col-sm-3 col-form-label text-uppercase"
							>Equity</label
						>
						<div class="col-sm-9">
							<input type="number" class="form-control" id="equity" />
						</div>
					</div>
					<div class="mb-3 row">
						<label for="repayment" class="col-sm-3 col-form-label text-uppercase"
							>Monthly Installment</label
						>
						<div class="col-sm-9">
							<input type="number" class="form-control" id="repayment" />
						</div>
					</div>

					<div class="mb-3 row">
						<button
							onclick="generate()"
							type="button"
							class="btn btn-primary"
							id="generateButton"
						>
							Generate document
						</button>
					</div>
				</form>
			</div>
		</main>
	</body>
	<script>
		let gen = document.getElementById('generateButton');
		function loadFile(url, callback) {
			PizZipUtils.getBinaryContent(url, callback);
		}
		function generate() {
			gen.innerText = 'loading';

			loadFile('ghanatemplate.docx', function (error, content) {
				if (error) {
					gen.innerText = 'Generate Document';

					throw error;
				}
				var zip = new PizZip(content);
				var doc = new window.docxtemplater(zip, {
					paragraphLoop: true,
					linebreaks: true,
				});

				// render the document
				// (replace all occurences of {first_name} by John, {last_name} by Doe)
				const date = document.getElementById('date').value;
				const name = document.getElementById('name').value;
				const no = document.getElementById('no').value;
				const street = document.getElementById('street').value;
				const lga = document.getElementById('lga').value;
				const state = document.getElementById('state').value;
				const amount = document.getElementById('amount').value;
				const interest = document.getElementById('interest').value;
				const tenure = document.getElementById('tenure').value;
				const make = document.getElementById('make').value;
				const model = document.getElementById('model').value;
				const year = document.getElementById('year').value;
				const condition = document.getElementById('condition').value;
				const vin = document.getElementById('vin').value;
				const carValue = document.getElementById('carValue').value;
				const equity = document.getElementById('equity').value;
				const repayment = document.getElementById('repayment').value;

				doc.render({
					date: date,
					name: name,
					address: `${no}, ${street}, ${lga}, ${state} `,
					amount: parseInt(amount).toLocaleString(undefined, {
						minimumFractionDigits: 2,
					}),
					amountInWord: toWordsconver(amount),
					interest: interest,
					tenure: tenure,
					make: make,
					model: model,
					year: year,
					condition: condition,
					vin: vin,
					carValue: parseInt(carValue).toLocaleString(undefined, {
						minimumFractionDigits: 2,
					}),
					carValueInWords: toWordsconver(carValue),
					equity: parseInt(equity).toLocaleString(undefined, {
						minimumFractionDigits: 2,
					}),
					equityInWords: toWordsconver(equity),
					repayment: parseInt(repayment).toLocaleString(undefined, {
						minimumFractionDigits: 2,
					}),
					repaymentInWords: toWordsconver(repayment),
					roadWorthiness: parseInt(roadWorthiness).toLocaleString(undefined, {
						minimumFractionDigits: 2,
					}),
				});

				var out = doc.getZip().generate({
					type: 'blob',
					mimeType:
						'application/vnd.openxmlformats-officedocument.wordprocessingml.document',
				});
				// Output the document using Data-URI
				saveAs(out, `${name}_Get_Gari_Loan_Agreement.docx`);
				gen.innerText = 'Generate Document';
			});
		}
	</script>
</html>
