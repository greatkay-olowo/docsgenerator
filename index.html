<html>
	<head>
		<!-- Required meta tags -->
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />

		<!-- Bootstrap CSS -->
		<link
			href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
			rel="stylesheet"
			integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
			crossorigin="anonymous"
		/>

		<title>Generate Loan Agreement and Direct Debit Mandates</title>
	</head>
	<body>
		<main class="my-5 mx-2">
			<div class="text-center text-uppercase fs-2 fw-bold my-5">
				Generate Loan Agreement and Direct Debit Mandates
			</div>
			<form class="col-lg-6 col-md-8 col-sm-12 mx-auto">
				<input type="file" id="doc" />
				<div class="mb-3 row">
					<label for="date" class="col-sm-3 col-form-label">Date</label>
					<div class="col-sm-9">
						<input type="date" class="form-control text-uppercase" id="date" />
					</div>
				</div>
				<div class="mb-3 row">
					<label for="date" class="col-sm-3 col-form-label">Employment Type</label>
					<div class="col-sm-9">
						<select
							class="form-select text-uppercase"
							aria-label="multiple select example"
							id="type"
						>
							<option selected></option>
							<option value="Salary Earner">Salary Earner</option>
							<option value="Business Owner">Business Owner</option>
						</select>
					</div>
				</div>
				<div class="mb-3 row">
					<label for="no" class="col-sm-3 col-form-label">House Number</label>
					<div class="col-sm-9">
						<input type="text" class="form-control text-uppercase" id="no" />
					</div>
				</div>
				<div class="mb-3 row">
					<label for="street" class="col-sm-3 col-form-label">Street Name</label>
					<div class="col-sm-9">
						<input type="text" class="form-control text-uppercase" id="street" />
					</div>
				</div>
				<div class="mb-3 row">
					<label for="lga" class="col-sm-3 col-form-label">LGA</label>
					<div class="col-sm-9">
						<input type="text" class="form-control text-uppercase" id="lga" />
					</div>
				</div>
				<div class="mb-3 row">
					<label for="state" class="col-sm-3 col-form-label">STATE</label>
					<div class="col-sm-9">
						<input type="text" class="form-control text-uppercase" id="state" />
					</div>
				</div>
				<div class="mb-3 row">
					<label for="amount" class="col-sm-3 col-form-label">LOAN AMOUNT</label>
					<div class="col-sm-9">
						<input type="number" class="form-control text-uppercase" id="amount" />
					</div>
				</div>
				<div class="mb-3 row">
					<label for="interest" class="col-sm-3 col-form-label text-uppercase"
						>INTEREST RATE per year</label
					>
					<div class="col-sm-9">
						<input type="number" class="form-control text-uppercase" id="interest" />
					</div>
				</div>
				<div class="mb-3 row">
					<label for="tenure" class="col-sm-3 col-form-label text-uppercase"
						>tenure</label
					>
					<div class="col-sm-9">
						<input type="number" class="form-control text-uppercase" id="tenure" />
					</div>
				</div>
				<div class="mb-3 row">
					<label for="make" class="col-sm-3 col-form-label text-uppercase"
						>Vehicle make</label
					>
					<div class="col-sm-9">
						<input type="text" class="form-control text-uppercase" id="make" />
					</div>
				</div>
				<div class="mb-3 row">
					<label for="model" class="col-sm-3 col-form-label text-uppercase"
						>Vehicle model</label
					>
					<div class="col-sm-9">
						<input type="text" class="form-control text-uppercase" id="model" />
					</div>
				</div>
				<div class="mb-3 row">
					<label for="year" class="col-sm-3 col-form-label text-uppercase"
						>Vehicle year</label
					>
					<div class="col-sm-9">
						<input type="text" class="form-control text-uppercase" id="year" />
					</div>
				</div>
				<div class="mb-3 row">
					<label for="condition" class="col-sm-3 col-form-label text-uppercase"
						>Vehicle condition</label
					>
					<div class="col-sm-9">
						<select
							class="form-select text-uppercase"
							aria-label="multiple select example"
							id="condition"
						>
							<option selected></option>
							<option value="Foreign Used">Foreign Used</option>
							<option value="New">New</option>
						</select>
					</div>
				</div>
				<div class="mb-3 row">
					<label for="vin" class="col-sm-3 col-form-label text-uppercase">VIN</label>
					<div class="col-sm-9">
						<input type="text" class="form-control text-uppercase" id="vin" />
					</div>
				</div>
				<div class="mb-3 row">
					<label for="carValue" class="col-sm-3 col-form-label text-uppercase"
						>Vehicle Price</label
					>
					<div class="col-sm-9">
						<input type="number" class="form-control text-uppercase" id="carValue" />
					</div>
				</div>
				<div class="mb-3 row">
					<label for="equity" class="col-sm-3 col-form-label text-uppercase"
						>Equity</label
					>
					<div class="col-sm-9">
						<input type="number" class="form-control text-uppercase" id="equity" />
					</div>
				</div>
				<div class="mb-3 row">
					<label for="repayment" class="col-sm-3 col-form-label text-uppercase"
						>Monthly Installment</label
					>
					<div class="col-sm-9">
						<input type="number" class="form-control text-uppercase" id="repayment" />
					</div>
				</div>
				<div class="mb-3 row">
					<label for="renewal" class="col-sm-3 col-form-label text-uppercase"
						>Monthly Renewal</label
					>
					<div class="col-sm-9">
						<input type="number" class="form-control text-uppercase" id="renewal" />
					</div>
				</div>
				<div class="mb-3 row">
					<label for="renewalPeriod" class="col-sm-3 col-form-label text-uppercase"
						>Number of months for nenewal</label
					>
					<div class="col-sm-9">
						<input
							type="number"
							class="form-control text-uppercase"
							id="renewalPeriod"
						/>
					</div>
				</div>

				<div class="mb-3 row">
					<button onclick="generate()" type="button" class="btn btn-primary">
						Generate document
					</button>
				</div>
			</form>
		</main>
	</body>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/docxtemplater/3.28.2/docxtemplater.js"></script>
	<script src="https://unpkg.com/pizzip@3.1.1/dist/pizzip.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.8/FileSaver.js"></script>
	<script src="https://unpkg.com/pizzip@3.1.1/dist/pizzip-utils.js"></script>
	<!--
    Mandatory in IE 6, 7, 8 and 9.
    -->
	<script
		type="text/javascript"
		src="https://unpkg.com/pizzip@3.1.1/dist/pizzip-utils-ie.js"
	></script>
	<script type="text/javascript" src="./toWord.js"></script>

	<script>
		async function loadFile(url, callback) {
			let file = await fetch(url, {
				method: 'GET',
				headers: {
					'Access-Control-Allow-Origin': '*',
				},
			}).then((response) =>
				console.log(
					'ðŸš€ ~ file: index.html ~ line 210 ~ loadFile ~ response',
					response,
				),
			);
			// let document = await file.text();

			// PizZipUtils.getBinaryContent(url, callback);
		}
		function generate() {
			loadFile(
				'https://github.com/greatkay-olowo/docsgenerator/blob/main/assets/documents/template.docx',
				function (error, content) {
					if (error) {
						throw error;
					}
					var zip = new PizZip(content);
					var doc = new window.docxtemplater(zip, {
						paragraphLoop: true,
						linebreaks: true,
					});

					// render the document
					// (replace all occurences of {first_name} by John, {last_name} by Doe)
					const date = document.getElementById('date');
					const name = document.getElementById('name');
					const no = document.getElementById('no');
					const street = document.getElementById('street');
					const lga = document.getElementById('lga');
					const state = document.getElementById('state');
					const interest = document.getElementById('interest');
					const tenure = document.getElementById('tenure');
					const make = document.getElementById('make');
					const model = document.getElementById('model');
					const year = document.getElementById('year');
					const condition = document.getElementById('condition');
					const vin = document.getElementById('vin');
					const carValue = document.getElementById('carValue');
					const equity = document.getElementById('equity');
					const repayment = document.getElementById('repayment');
					const renewal = document.getElementById('renewal');
					const renewalPeriod = document.getElementById('renewalPeriod');
					doc.render({
						date: date,
						name: name,
						address: `${no} ${street} ${lga} ${state} `,
						amount: amount,
						amountInWord: toWordsconver(amount),
						interest: interest,
						tenure: tenure,
						make: make,
						model: model,
						year: year,
						condition: condition,
						vin: vin,
						carValue: carValue,
						carValueInWords: toWordsconver(carValue),
						equity: equity,
						equityInWords: toWordsconver(equity),
						repayment: repayment,
						repaymentInWords: toWordsconver(repayment),
						renewal: renewal,
						renewalInWords: toWordsconver(renewal),
						renewalPeriod: renewalPeriod,
						totalRenewal: renewal * renewalPeriod,
						totalRenewalInWords: toWordsconver(renewal * renewalPeriod),
						totalRepayment: repayment + renewal,
						totalRepaymentInWords: toWordsconver(repayment + renewal),
					});

					var out = doc.getZip().generate({
						type: 'blob',
						mimeType:
							'application/vnd.openxmlformats-officedocument.wordprocessingml.document',
					});
					// Output the document using Data-URI
					saveAs(out, 'output.docx');
				},
			);
		}
	</script>
</html>
